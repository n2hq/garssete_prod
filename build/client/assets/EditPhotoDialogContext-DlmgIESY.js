import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as t}from"./components-t0No8UbM.js";import{u as F}from"./NotificationContext-1jS5Nfi7.js";import{u as L}from"./OperationContext-BXLbD7tl.js";import{Q as J,s as Q}from"./lib-BT3-1uX3.js";const z=t.createContext(null);function te(){return t.useContext(z)}function se({children:u}){const[P,l]=t.useState(!1),[m,p]=t.useState(!1),[g,r]=t.useState(null),[h,I]=t.useState(null),[x,k]=t.useState(null),[f,y]=t.useState(!1),[w,j]=t.useState(null);F();const{showOperation:_,showError:b,completeOperation:S,showSuccess:D}=L(),A=()=>{p(!1),r(null)},O=async()=>{l(!0);let d=document.getElementById("image_title");if(f){const n=new FormData;n.append("file",w),n.append("guid",h),n.append("bid",x),n.append("image_title",d.value),_("processing","Saving picture"),await new Promise(i=>setTimeout(i,2e3));const C="https://pics.gasimg.com"+"/business_gallery_pic_upload";try{const i=await fetch(C,{method:"POST",headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"*"},body:n});if(i.ok)try{D("Success","Picture saved."),S()}finally{window.location.reload()}else{let R=i.json().then(M=>{b("Error",`${M.message}`),S()})}}catch{return}finally{l(!1)}}else b("Error","Please select an image to continue."),l(!1)};let N={dialog:m,setDialog:p,imgSrc:g,setImgSrc:r,handleCloseDialog:A,userGuid:h,setUserGuid:I,businessGuid:x,setBusinessGuid:k,isImgSelected:f,setIsImageSelected:y,selectedFile:w,setSelectedFile:j};return e.jsxs(z.Provider,{value:N,children:[m&&e.jsx("div",{className:`flex w-screen h-screen z-[3000] 
                fixed top-0 left-0 right-0 bottom-0 bg-black/30
                place-content-center place-items-center`,children:e.jsxs("div",{className:`relative w-[90%] h-[80%] bg-white 
                        rounded-[8px] overflow-x-hidden z-[3000]`,onClick:d=>{d.preventDefault()},children:[e.jsx("div",{className:"relative w-full h-[75%] bg-black",children:e.jsx("img",{src:g,alt:"",className:"object-scale-down w-full h-full"})}),e.jsx("div",{children:e.jsx("textarea",{id:"image_title",placeholder:"Enter picture description.",className:"w-full bg-gray-100 px-3  h-[60px] py-3"})}),e.jsxs("div",{className:"flex place-content-end px-3 gap-2",children:[e.jsx("button",{onMouseDown:()=>A(),className:`bg-gray-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md mb-2 mt-4`,children:"Close"}),e.jsx("button",{onClick:()=>O(),className:`bg-blue-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md mb-2 mt-4`,children:P?"Working...":"Submit"})]})]})}),u]})}const W=t.createContext(null);function oe(){return t.useContext(W)}function le({children:u}){const[P,l]=t.useState(!1),[m,p]=t.useState(!1),[g,r]=t.useState(null),[h,I]=t.useState(null),[x,k]=t.useState(null),[f,y]=t.useState(!1),[w,j]=t.useState(null),[_,b]=t.useState(null),[S,D]=t.useState(null),[A,O]=t.useState(null),N=t.useRef(null);F();const{showOperation:d,showError:n,completeOperation:E,showSuccess:G}=L(),C=()=>{p(!1),r(null),l(!1)},i=()=>{var o;(o=N.current)==null||o.click()},R=o=>{var v;const s=(v=o.target.files)==null?void 0:v[0];if(s){const U=URL.createObjectURL(s);r(U),j(s),y(!0)}},M=async()=>{d("processing"),l(!0),await new Promise(c=>setTimeout(c,1e3));let o=document.getElementById("image_title");const s=new FormData;f&&s.append("file",w),s.append("guid",h),s.append("bid",x),s.append("image_title",o.value),s.append("image_guid",S);const B="https://pics.gasimg.com"+"/business_gallery_pic_update";try{const c=await fetch(B,{method:"POST",headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"*"},body:s});if(c.ok)try{G("Success","Picture updated."),E()}finally{}else{let T=c.json().then(a=>{n("Error",`${a.message}`)})}}catch{return}finally{l(!1)}};let $={dialog:m,setDialog:p,handleCloseDialog:C,imgSrc:g,setImgSrc:r,userGuid:h,setUserGuid:I,businessGuid:x,setBusinessGuid:k,isImgSelected:f,setIsImageSelected:y,selectedFile:w,setSelectedFile:j,imageTitle:_,setImageTitle:b,imageGuid:S,setImageGuid:D,deletePhoto:async(o,s,v)=>{const c="https://pics.gasimg.com"+"/delete_business_gallery_pic",T={guid:o,bid:s,image_guid:v};l(!0),d("processing"),await new Promise(a=>setTimeout(a,1e3));try{const a=await fetch(c,{method:"POST",headers:Q,body:JSON.stringify(T)});if(a.ok)try{G("Success","Picture deleted."),E()}finally{window.location.reload()}else{let K=a.json().then(q=>{n("Error",`${q.message}`),E()})}}catch(a){console.log(a.message),n("Error","Image not deleted.")}finally{l(!1)}}};return e.jsxs(W.Provider,{value:$,children:[m&&e.jsx("div",{className:"fixed w-screen h-screen bg-black/30 z-[3000]",children:e.jsx("div",{className:`fixed w-screen h-screen z-[3000] 
                 top-0 left-0 right-0 bottom-0 bg-black/30
                place-content-center place-items-center`,children:e.jsx("div",{className:`relative max-w-[90%] w-[90%] h-[80%] bg-white 
                        rounded-[8px] overflow-hidden z-[3100] mx-auto `,children:e.jsxs("div",{className:"w-full h-full overflow-y-auto",children:[e.jsxs("div",{className:"relative w-full h-[75%] bg-black",children:[e.jsx("img",{src:g,alt:"",className:"object-scale-down w-full h-full"}),e.jsx("input",{type:"file",accept:"image/*",ref:N,className:"hidden",onChange:R}),e.jsx("div",{className:`flex place-content-center place-items-center
                                        bg-black/10 w-full h-full absolute z-0 top-0 object-cover
                                        text-white/80 `,onMouseDown:i,children:e.jsx("div",{className:`w-[60px] h-[60px] flex flex-col
                                        place-content-center place-items-center bg-white/50
                                        hover:cursor-pointer hover:bg-white/50
                                        rounded-full transition duration-300 ease-in-out`,children:e.jsx(J,{className:" text-[30px]"})})})]}),e.jsxs("div",{className:"h-[25%]",children:[e.jsx("textarea",{onChange:o=>b(o.target.value),id:"image_title",value:_,placeholder:"Enter picture description.",className:"w-full bg-gray-100 px-3  h-[60px] py-3"}),e.jsxs("div",{className:"flex place-content-end px-3 gap-2",children:[e.jsx("button",{onMouseDown:()=>window.location.reload(),className:`bg-gray-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md mb-2 mt-4`,children:"Reload"}),e.jsx("button",{onMouseDown:()=>C(),className:`bg-gray-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md mb-2 mt-4`,children:"Close"}),e.jsx("button",{onClick:()=>M(),className:`bg-blue-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md mb-2 mt-4`,children:P?"Working...":"Submit"})]})]})]})})})}),u]})}export{se as A,le as E,oe as a,te as u};
