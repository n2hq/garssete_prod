import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as t,c as oe}from"./components-BgCvqN9p.js";import{A as le}from"./AccountLayout-CNNzrTDI.js";import{C as ne}from"./ContentLayout-D_M4y-dK.js";import{J as Y,s as H,N as V,t as ae,as as re,B as ie,a as ce,O as de,aD as ue,U as me}from"./lib-B5CJHXEq.js";import{u as pe}from"./AuthContext-CJZGuvtq.js";import{u as $}from"./NotificationContext-DexQTEg0.js";import{u as Q}from"./OperationContext-C5fIEC6d.js";import{I as he}from"./index-Bmix0W_x.js";import{u as xe,P as ge}from"./ProductSliderContext-oy-4uhM4.js";import"./UserMenu-BGcyOhXR.js";import"./HomeNav-C4_KFq1z.js";import"./SrchNavbar-DgQ69Q48.js";import"./HamburgerSecondary-BXRtfWu4.js";import"./json-BNGep5mz.js";import"./BusinessMenu-Bt_k1cKU.js";import"./BusinessDrawer-DiqxpHSC.js";const Z=t.createContext(null);function fe(){return t.useContext(Z)}function we({children:s}){const[o,l]=t.useState(!1),[i,n]=t.useState(!1),[p,m]=t.useState(null),[u,r]=t.useState(null),[f,h]=t.useState(null),[g,x]=t.useState(!1),[y,_]=t.useState(null),[w,v]=t.useState(null),[P,E]=t.useState(null),[I,L]=t.useState(null),[te,se]=t.useState(null),B=t.useRef(null),R=$(),{showOperation:q,showError:K,completeOperation:G,showSuccess:O}=Q(),C=()=>{n(!1),m(null),l(!1)},M=()=>{var d;(d=B.current)==null||d.click()},T=d=>{var D;const k=(D=d.target.files)==null?void 0:D[0];if(k){const a=URL.createObjectURL(k);m(a),_(k),x(!0)}},z=async()=>{q("processing"),l(!0),await new Promise(c=>setTimeout(c,1e3));let d=document.getElementById("product_title"),k=document.getElementById("product_description"),D=document.getElementById("product_link");const a=new FormData;g&&a.append("file",y),a.append("guid",u),a.append("bid",f),a.append("product_title",d.value||""),a.append("product_description",k.value||""),a.append("product_link",D.value||"");const j=V.IMG_BASE_URL+"/business_gallery_product_upload";try{const c=await fetch(j,{method:"POST",headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"*"},body:a});if(c.ok)try{O("Success","Product saved."),G()}finally{window.location.reload()}else{let N=c.json().then(A=>{console.log(A.message),K("Error",`Failed to add product: ${A.message}`),G()})}}catch{return}finally{l(!1)}};let F={dialog:i,setDialog:n,handleCloseDialog:C,imgSrc:p,setImgSrc:m,userGuid:u,setUserGuid:r,businessGuid:f,setBusinessGuid:h,isImgSelected:g,setIsImageSelected:x,selectedFile:y,setSelectedFile:_,productTitle:w,setProductTitle:v,productDescription:I,setProductDescription:L,productLink:P,setProductLink:E,deleteProduct:async(d,k,D)=>{const j="https://pics.gasimg.com"+"/delete_business_gallery_pic",c={guid:d,bid:k,image_guid:D};l(!0),await new Promise(N=>setTimeout(N,1e3));try{const N=await fetch(j,{method:"POST",headers:H,body:JSON.stringify(c)});if(N.ok)R.alertReload("","Image deleted successfully!");else{let A=N.json().then(U=>{R.alert(U.message)})}}catch(N){return alert(N.message)}finally{l(!1)}}};return e.jsxs(Z.Provider,{value:F,children:[i&&e.jsx("div",{onMouseDown:d=>n(!1),className:`fixed w-screen h-screen z-[3100] 
                 top-0 left-0 right-0 bottom-0 bg-black/30
                place-content-center place-items-center`,children:e.jsx("div",{className:`relative max-w-[90%] w-[90%] h-[80%] bg-white 
                        rounded-[8px] overflow-hidden z-[3100] mx-auto `,onMouseDown:d=>d.stopPropagation(),children:e.jsxs("div",{className:"w-full h-full overflow-y-auto",children:[e.jsxs("div",{className:"relative w-full h-[75%] bg-black",children:[e.jsx("img",{src:p,alt:"",className:"object-scale-down w-full h-full"}),e.jsx("input",{type:"file",accept:"image/*",ref:B,className:"hidden",onChange:T}),e.jsx("div",{className:`flex place-content-center place-items-center
                                        bg-black/10 w-full h-full absolute z-0 top-0 object-cover
                                        text-white/80 `,onMouseDown:M,children:e.jsx("div",{className:`w-[60px] h-[60px] flex flex-col
                                        place-content-center place-items-center bg-white/50
                                        hover:cursor-pointer hover:bg-white/50
                                        rounded-full transition duration-300 ease-in-out`,children:e.jsx(Y,{className:" text-[30px]"})})})]}),e.jsxs("div",{className:"h-[25%] space-y-1",children:[e.jsxs("div",{className:"flex mb-1 flex-col mx-3 ",children:[e.jsx("div",{className:"text-[14px] font-semibold py-1",children:"Enter product title"}),e.jsx("input",{onChange:d=>v(d.target.value),id:"product_title",value:w||"",placeholder:"Enter product title.",className:"w-full border-[1px] border-gray-700 bg-gray-100 px-3 py-4 outline-none rounded-lg"})]}),e.jsxs("div",{className:"flex mb-1 flex-col mx-3 ",children:[e.jsx("div",{className:"text-[14px] font-semibold py-1",children:"Enter product description"}),e.jsx("textarea",{onChange:d=>L(d.target.value),id:"product_description",value:I||"",placeholder:"Enter product description.",className:"w-full border-[1px] border-gray-700 bg-gray-100 px-3 py-4 outline-none rounded-lg"})]}),e.jsxs("div",{className:"flex mb-1 flex-col mx-3 ",children:[e.jsx("div",{className:"text-[14px] font-semibold py-1",children:"Enter product link"}),e.jsx("input",{onChange:d=>E(d.target.value),id:"product_link",value:P||"",placeholder:"Enter product link.",className:"w-full border-[1px] border-gray-700 bg-gray-100 px-3 py-4 outline-none rounded-lg"})]}),e.jsxs("div",{className:"flex place-content-end px-3 gap-2",children:[e.jsx("button",{onMouseDown:()=>C(),className:`bg-gray-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md mb-2 mt-4`,children:"Cancel"}),e.jsx("button",{onClick:()=>z(),className:`bg-blue-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md mb-2 mt-4`,children:o?"Working...":"Submit"})]})]})]})})}),s]})}const be=({userGuid:s,businessGuid:o})=>{const l=fe(),i=()=>{l.setDialog(!0),l.setUserGuid(s),l.setBusinessGuid(o)};return e.jsx("div",{className:"mb-2",children:e.jsx("button",{onMouseDown:i,className:` bg-blue-800 rounded-md px-3 py-1
                text-white hover:bg-blue-700 transition
                duration-500 ease-in-out hover:shadow-md
                 shadow-gray-900 hover:shadow-black/50`,children:"Add Product"})})},ee=t.createContext(null);function ve(){return t.useContext(ee)}function je({children:s}){const[o,l]=t.useState(!1),[i,n]=t.useState(!1),[p,m]=t.useState(null),[u,r]=t.useState(null),[f,h]=t.useState(null),[g,x]=t.useState(!1),[y,_]=t.useState(null),[w,v]=t.useState(null),[P,E]=t.useState(null),[I,L]=t.useState(null),[te,se]=t.useState(null),[B,R]=t.useState("null"),[q,K]=t.useState(null),G=t.useRef(null);$();const{showOperation:O,showError:C,completeOperation:M,showSuccess:T}=Q(),z=()=>{n(!1),m(null),l(!1)},X=()=>{var a;(a=G.current)==null||a.click()},F=a=>{var j;const S=(j=a.target.files)==null?void 0:j[0];if(S){const c=URL.createObjectURL(S);m(c),_(S),x(!0)}},d=async()=>{O("processing"),l(!0),await new Promise(b=>setTimeout(b,1e3));let a=document.getElementById("product_title"),S=document.getElementById("product_description"),j=document.getElementById("product_link");const c=new FormData;g&&c.append("file",y),c.append("guid",u),c.append("bid",f),c.append("product_title",a.value),c.append("product_description",S.value),c.append("product_link",j.value),c.append("product_guid",B);const U="https://pics.gasimg.com"+"/business_gallery_product_update";console.log(Object.fromEntries(c.entries()));try{const b=await fetch(U,{method:"POST",headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"*"},body:c});if(b.ok)T("Success","Product saved."),M();else{let W=b.json().then(J=>{console.log(J.message),C("Error","Update failed"),M()})}}catch{return}finally{l(!1)}};let D={dialog:i,setDialog:n,handleCloseDialog:z,imgSrc:p,setImgSrc:m,userGuid:u,setUserGuid:r,businessGuid:f,setBusinessGuid:h,isImgSelected:g,setIsImageSelected:x,selectedFile:y,setSelectedFile:_,productTitle:w,setProductTitle:v,productDescription:P,setProductDescription:E,productLink:I,setProductLink:L,productGuid:B,setProductGuid:R,deleteProduct:async(a,S,j)=>{const A="https://pics.gasimg.com"+"/delete_business_product",U={guid:a,bid:S,product_guid:j};O("processing"),l(!0),await new Promise(b=>setTimeout(b,1e3));try{const b=await fetch(A,{method:"POST",headers:H,body:JSON.stringify(U)});if(b.ok)try{T("Success","Product deleted."),M(),await new Promise(W=>setTimeout(W,500))}finally{window.location.reload()}else{let W=b.json().then(J=>{console.log(J),C("Error","Delete failed."),M()})}}catch(b){C("Error","Product delete failed."),console.log(b.message)}finally{l(!1)}}};return e.jsxs(ee.Provider,{value:D,children:[i&&e.jsx("div",{className:"fixed w-screen h-screen bg-black/30 z-[3000]",children:e.jsx("div",{className:`fixed w-screen h-screen z-[3000] 
                 top-0 left-0 right-0 bottom-0 bg-black/30
                place-content-center place-items-center`,children:e.jsx("div",{className:`relative max-w-[90%] w-[90%] h-[80%] bg-white 
                        rounded-[8px] overflow-hidden z-[3100] mx-auto `,children:e.jsxs("div",{className:"w-full h-full overflow-y-auto",children:[e.jsxs("div",{className:"relative w-full h-[75%] bg-black",children:[e.jsx("img",{src:p,alt:"",className:"object-scale-down w-full h-full"}),e.jsx("input",{type:"file",accept:"image/*",ref:G,className:"hidden",onChange:F}),e.jsx("div",{className:`flex place-content-center place-items-center
                                        bg-black/10 w-full h-full absolute z-0 top-0 object-cover
                                        text-white/80 `,onMouseDown:X,children:e.jsx("div",{className:`w-[60px] h-[60px] flex flex-col
                                        place-content-center place-items-center bg-white/50
                                        hover:cursor-pointer hover:bg-white/50
                                        rounded-full transition duration-300 ease-in-out`,children:e.jsx(Y,{className:" text-[30px]"})})})]}),e.jsxs("div",{className:"h-[25%]",children:[e.jsx("input",{onChange:a=>v(a.target.value),id:"product_title",value:w||"",placeholder:"Enter product title.",className:"w-full bg-gray-100 px-3  py-3 mb-1"}),e.jsx("textarea",{onChange:a=>E(a.target.value),id:"product_description",value:P||"",placeholder:"Enter product description.",className:"w-full bg-gray-100 px-3  h-[60px] py-3"}),e.jsx("input",{onChange:a=>L(a.target.value),id:"product_link",value:I||"",placeholder:"Enter product link.",className:"w-full bg-gray-100 px-3 py-3"}),e.jsxs("div",{className:"flex place-content-end px-3 gap-2",children:[e.jsx("button",{onMouseDown:()=>window.location.reload(),className:`bg-gray-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md mb-2 mt-4`,children:"Reload"}),e.jsx("button",{onMouseDown:()=>z(),className:`bg-gray-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md mb-2 mt-4`,children:"Close"}),e.jsx("button",{onClick:()=>d(),className:`bg-blue-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md mb-2 mt-4`,children:o?"Working...":"Submit"})]})]})]})})})}),s]})}const ye=({product:s,menu:o,userGuid:l,businessGuid:i})=>{const[n,p]=t.useState(!1),[m,u]=t.useState(null),r=ve();$();const f=()=>{r.setDialog(!0),r.setImgSrc(V.IMG_BASE_URL+s.product_image_url),r.setProductTitle(s.product_title),r.setProductDescription(s.product_description),r.setProductLink(s.product_link),r.setProductGuid(s.product_guid),r.setUserGuid(l),r.setBusinessGuid(i)},h=async()=>{r.deleteProduct(l,i,s.product_guid)};return e.jsx("div",{className:"",children:o&&e.jsx("div",{className:` absolute top-2 right-2 w-[80%] bg-white
                rounded-[12px] overflow-hidden border-[1px] border-white
                shadow-md`,children:e.jsx("div",{className:"mt-3",children:e.jsxs("div",{className:" divide-y-[1px]",children:[e.jsx("div",{onMouseDown:f,className:`py-1 hover:bg-gray-300 w-full
                                flex flex-col
                                px-2 transition duration-1000 ease-in-out`,children:"Edit"}),e.jsx("div",{onMouseDown:h,className:`py-1 hover:bg-gray-300 w-full
                                flex flex-col
                                px-2 transition duration-1000 ease-in-out`,children:"Delete"})]})})})})},Se=({showCarousel:s,product:o,itemIndex:l,userGuid:i,businessGuid:n})=>{const[p,m]=t.useState(!1),[u,r]=t.useState(null),f="https://pics.gasimg.com";let h="";o.product_image_url?h=f+o.product_image_url:h="https://trendyblinds.ca/wp-content/uploads/2023/09/3.-3D-WALLPAPER-SKU0015.jpg";const[g,x]=t.useState(h),y=()=>{m(!0)},_=async()=>{await new Promise(w=>setTimeout(w,200)),m(!1)};return t.useEffect(()=>{if(o){const w=ae(o==null?void 0:o.product_link);r(w)}},[o]),e.jsx("div",{className:"z-0",children:e.jsxs("div",{className:`border-[1px] h-fit p-1 rounded-md shadow-md
                    hover:cursor-pointer relative z-0`,children:[e.jsx("button",{onMouseDown:y,onBlur:_,className:`w-[30px] h-[30px] z-50 bg-white 
                flex place-content-center place-items-center 
                rounded-full absolute right-2 top-2 cursor-pointer
                hover:bg-gray-500 hover:text-white/80 transition duration-1000 ease-in-out`,children:e.jsx(re,{className:"text-[20px]"})}),e.jsx("div",{onMouseDown:w=>s(l),className:`relative h-[100px] md:h-[170px] xl:h-[160px]
                         rounded-md overflow-hidden -z-10
                    `,children:e.jsx("img",{src:V.IMG_BASE_URL+(o==null?void 0:o.product_image_url),alt:"",className:`object-cover w-full h-full -z-40
                        `})}),(o==null?void 0:o.product_title).length>0&&e.jsx("div",{className:"text-[13px] mt-2 mb-1.5 leading-[1.2em] mx-[2px] line-clamp-2",children:o==null?void 0:o.product_title}),e.jsx(ye,{product:o,menu:p,userGuid:i,businessGuid:n})]})})},Ne=({slides:s,selectedSlide:o,handleClose:l})=>{const[i,n]=t.useState(0);t.useRef(0),t.useRef(0);const p=()=>{n(u=>u===0?s.length-1:u-1)},m=()=>{n(u=>u===s.length-1?0:u+1)};return t.useEffect(()=>{o!==null&&n(o-1)},[o]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-12 gap-0 ",children:[e.jsxs("div",{className:"col-span-12 md:col-span-9 w-full h-full relative bg-black flex",children:[e.jsx("div",{className:" w-auto h-screen flex overflow-hidden",children:s.map((u,r)=>e.jsx("img",{src:u.image_url,alt:"",style:{transform:`translateX(-${i*100}%)`},className:`object-scale-down w-full h-full 
                                            block flex-shrink-0 flex-grow-0 transition-transform
                                            ease-in-out duration-1000`},r))}),e.jsx("button",{onMouseDown:p,className:`block absolute top-0 bottom-0 
                p-[1rem] cursor-pointer left-0 group h-full 
                transition duration-1000 ease-in-out`,children:e.jsx("div",{className:`w-[50px] h-[50px] bg-white/60 rounded-full place-content-center place-items-center group-hover:bg-white/30
                        transition duration-500 ease-in-out`,children:e.jsx(ie,{className:" stroke-white fill-black w-[2rem] h-[2rem]"})})}),e.jsx("button",{onMouseDown:m,className:`block absolute top-0 bottom-0 
                    p-[1rem] cursor-pointer right-0 group 
                     transition duration-1000 ease-in-out`,children:e.jsx("div",{className:`w-[50px] h-[50px] bg-white/60 rounded-full flex place-content-center place-items-center group-hover:bg-white/30
                        transition duration-500 ease-in-out`,children:e.jsx(ce,{className:" stroke-white fill-black w-[2rem] h-[2rem]"})})}),e.jsx("div",{onMouseDown:()=>l(),className:`w-[50px] h-[50px] z-[300] bg-white
                    flex place-content-center place-items-center
                    rounded-full absolute left-2 top-2 cursor-pointer
                    hover:bg-white/40 transition duration-1000 ease-in-out`,children:e.jsx(he,{className:"text-[30px]"})})]}),e.jsxs("div",{className:"hidden md:block md:col-span-3 px-5",children:[e.jsx("h1",{className:" text-[22px] my-4 font-sans font-extrabold tracking-tight leading-[24px]",children:"Photos for Jason Won, DPT - Flex With Doctor Jay"}),e.jsxs("div",{className:" my-4 ",children:[i+1," / ",s.length]}),e.jsx("hr",{}),e.jsx("div",{className:" my-4",children:s[i].image_title})]})]})})},_e=({overlay:s,setOverlay:o,selectedSlide:l,handleClose:i,gallery:n})=>e.jsx("div",{children:s&&e.jsx("div",{className:`flex w-screen h-screen bg-white z-[1000] 
                fixed top-0 left-0 right-0 bottom-0 `,children:n&&l&&e.jsx(Ne,{slides:n,selectedSlide:l,handleClose:i})})}),Pe=({productGallery:s,userGuid:o,businessGuid:l,listing:i})=>{const[n,p]=t.useState(!1),[m,u]=t.useState(0),r=xe(),f=()=>{p(!1)},h=g=>{r.setDialog(!0),r.setSelectedSlide(g+1),r.setGallery(s),r.setListing(i)};return e.jsxs("div",{className:"",children:[e.jsx("div",{className:` border-[1px] p-3 rounded-[5px] 
                grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4
                lg:grid-cols-4 xl:grid-cols-5 gap-2 z-0`,children:s==null?void 0:s.map((g,x)=>e.jsx("div",{className:"z-0",children:e.jsx(Se,{showCarousel:h,product:g,itemIndex:x,userGuid:o,businessGuid:l})},x))}),e.jsx(_e,{overlay:n,setOverlay:p,selectedSlide:m+1,handleClose:f,gallery:s})]})},Je=()=>{t.useEffect(()=>{de(localStorage)},[]);const[s,o]=t.useState(""),[l,i]=t.useState(""),[n,p]=t.useState(null),[m,u]=t.useState(null),[r,f]=t.useState(!0),{business_guid:h,user_guid:g}=oe(),[x,y]=t.useState(null);return pe()?(t.useEffect(()=>{const w=async(v,P)=>{o(v),i(P);const E=await ue(v,P);p(E);const I=await me(v||"");y(I)};try{h&&g&&w(h,g)}catch(v){console.log(v.message)}},[h,g]),t.useEffect(()=>{s&&l&&n&&x&&(u({businessGuid:s,userGuid:l,productGallery:n,businessProfile:x}),f(!1))},[s,l,n,x]),r?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"text-lg",children:"Loading..."})}):e.jsx(je,{children:e.jsx(ge,{children:e.jsx(we,{children:e.jsx(le,{children:e.jsxs(ne,{title:"Product Settings",businessGuid:s,data:m,businessProfile:x,children:[s&&l&&e.jsx(be,{userGuid:l,businessGuid:s}),n!==null&&(n==null?void 0:n.length)>0?e.jsx("div",{className:"z-0",children:e.jsx(Pe,{productGallery:n,userGuid:l,businessGuid:s,listing:x})}):e.jsx("div",{className:" mt-2 border-[1px] rounded-lg p-3 mb-6",children:"Video Gallery is empty."})]})})})})})):null};export{Je as default};
