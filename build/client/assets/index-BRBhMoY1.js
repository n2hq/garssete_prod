import{j as t}from"./jsx-runtime-0DLF9kdB.js";import{u as T,s as E}from"./zod-VB2z1YQj.js";import{r as i,c as B}from"./components-BgCvqN9p.js";import{a4 as A,O as W,a5 as F,U as L}from"./lib-B5CJHXEq.js";import{z as s}from"./index-C4bLmoCR.js";import{A as $}from"./AccountLayout-CNNzrTDI.js";import{C as D}from"./ContentLayout-D_M4y-dK.js";import{u as G}from"./NotificationContext-DexQTEg0.js";import{u as I,O as R}from"./OperationContext-C5fIEC6d.js";import{f as V}from"./UserMenu-BGcyOhXR.js";import{u as z}from"./AuthContext-CJZGuvtq.js";import"./HomeNav-C4_KFq1z.js";import"./SrchNavbar-DgQ69Q48.js";import"./HamburgerSecondary-BXRtfWu4.js";import"./json-BNGep5mz.js";import"./BusinessMenu-Bt_k1cKU.js";import"./BusinessDrawer-DiqxpHSC.js";import"./index-Bmix0W_x.js";const U=/^(?!https?)(?!www\.?).*\..+$/g,q=s.object({username:s.any(),title:s.string().min(1,{message:"Enter a business name"}).min(3,{message:"Busines Name must not be less than 3 characters"}).max(100,{message:"Business name must not be more than 100 characters."}),country_code:s.string({message:"Please select a country"}).min(1,{message:"Please enter a country code."}),address_one:s.string({message:"Please enter an address"}).min(3,{message:"Address must not be less than 3 characters"}).max(100,{message:"Address must not be more than 100 characters"}),address_two:s.any(),state_code:s.any(),state_text:s.any(),country_text:s.any(),city:s.any(),established:s.string({message:"Please enter year established"}).min(4,{message:"Year must be at least 4 characters"}),call_code:s.any(),call_mobile:s.any(),zipcode:s.any(),intro:s.any(),category:s.string().min(2,{message:"Please select a business category"}),business_phrases:s.string({message:"Please enter business phrase"}).min(3,{message:"Business Phrases must not be less than 3 characters"}).max(1e3,{message:"Business Phrases must not be more than 100 characters"}),products:s.string({message:"Please enter products offered"}),services:s.union([s.string({message:"Please enter services offered"}).min(3,{message:"Please enter up to 3 characters"}),s.literal("")]),xsocial:s.any(),fbsocial:s.any(),linksocial:s.any(),website:s.union([s.string().regex(U).nullish(),s.literal("")]),email:s.string({message:"Please enter an email."}).min(1,{message:"Email must not be empty"}).email({message:"Please enter a valid email"})}).superRefine((o,u)=>{var l,a;((l=o==null?void 0:o.address_two)==null?void 0:l.length)!==0&&((a=o==null?void 0:o.address_two)==null?void 0:a.length)<3&&u.addIssue({code:s.ZodIssueCode.custom,path:["address_two"],message:"Enter a minimum of 3 characters"})}),k=["Closed","08:00","08:30","09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30","19:00","19:30","20:00","20:30","21:00","21:30","22:00","22:30","23:00","23:30","24:00"],M=({data:o,onChange:u,options:l})=>{const[a,c]=i.useState(null),[m,d]=i.useState("no_hours"),[b,v]=i.useState(!1);G();const{showOperation:w,completeOperation:_,showError:g,showSuccess:j}=I(),h=async e=>{const r=e;return{Monday:{start:r.monday_from,end:r.monday_to},Tuesday:{start:r.tuesday_from,end:r.tuesday_to},Wednesday:{start:r.wednesday_from,end:r.wednesday_to},Thursday:{start:r.thursday_from,end:r.thursday_to},Friday:{start:r.friday_from,end:r.friday_to},Saturday:{start:r.saturday_from,end:r.saturday_to},Sunday:{start:r.sunday_from,end:r.sunday_to}}};i.useEffect(()=>{(async()=>{const r=await h(o.operatingHours);c(r),u(r),d(o.operatingHours.open_status)})()},[o.operatingHours]);const S=(e,r,n)=>{if(!a)return;let p=n;if(a[e].end<=p&&p!=="Closed"){alert(`For ${e}, closing time must be later than opening time.`);return}c({...a,[e]:{...a[e],[r]:n}}),u(a)},f=(e,r,n)=>{if(!a)return;let p=a[e].start;if(n<=p&&p!=="Closed"){alert(`For ${e}, closing time must be later than opening time.`);return}c({...a,[e]:{...a[e],[r]:n}}),u(a)},x=async()=>{if(m===null)return g("Error","Please select working hours."),!1;v(!0),w("processing","Request is being processed."),await new Promise(e=>setTimeout(e,1e3));try{const e=await A(m,a,o.businessGuid,o.userGuid);console.log(e),_(),j("Success","Working hours saved."),v(!1)}catch(e){console.log(e.message),g("error","Business working hours could not be saved.")}};return a?t.jsx("div",{children:t.jsx("div",{className:`${V}`,children:t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"w-full",children:l.map(e=>t.jsxs("label",{className:`flex items-center gap-3 p-3 rounded cursor-pointer ${m===e.value?" bg-blue-50":"border-gray-300"}`,children:[t.jsx("div",{className:"w-[20px]",children:t.jsx("input",{type:"radio",name:"openStatus",value:e.value,checked:m===e.value,onChange:()=>d(e.value),className:"accent-blue-600 w-[20px] h-[20px]"})}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-gray-800",children:e.label}),t.jsx("span",{className:"text-[13px] text-gray-500",children:e.more})]})]},e.value))}),m==="selected_hours"&&Object.keys(a).map(e=>{var r;return t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("span",{className:"w-24 font-semibold",children:e}),t.jsxs("select",{value:((r=a[e])==null?void 0:r.start)||"",onChange:n=>S(e,"start",n.target.value),className:"border p-2 rounded",children:[t.jsx("option",{value:"",children:"From..."}),k.map(n=>t.jsx("option",{value:n,children:n},n))]}),t.jsx("span",{children:"to"}),t.jsxs("select",{value:a[e].end||"",onChange:n=>f(e,"end",n.target.value),className:"border p-2 rounded",children:[t.jsx("option",{value:"",children:"To..."}),k.map(n=>t.jsx("option",{value:n,children:n},n))]})]},e)}),t.jsx("div",{children:t.jsx("button",{onClick:x,className:`mt-6 bg-blue-600 text-white px-6 py-2 
                            rounded hover:bg-blue-700 transition
                            shadow-md hover:shadow-lg hover:shadow-black/50`,children:b?"Saving...":"Save Business Hours"})})]})})}):t.jsx("p",{children:"Loading working hours..."})},he=()=>{i.useEffect(()=>{W(localStorage)},[]);const[o,u]=i.useState(!0),[l,a]=i.useState(""),[c,m]=i.useState(""),[d,b]=i.useState(),[v,w]=i.useState([]),_=[{value:"no_hours",label:"No Hours Available",more:"Visitors won't see business hours on this Page"},{value:"always_open",label:"Always Open",more:"e.g. Parks, beaches, roads"},{value:"permanently_closed",label:"Permanently Closed",more:"Permantently closed"},{value:"temporarily_closed",label:"Temporarily Closed",more:"Temporarily closed"},{value:"selected_hours",label:"Open During Selected Hours",more:"Open during selected hours"}],[g,j]=i.useState(null),[h,S]=i.useState(null),{business_guid:f,user_guid:x}=B();z(),i.useEffect(()=>{const N=async(y,H)=>{a(y),m(H);const O=await F(y,H);b(O);const C=await L(y||"");S(C)};try{f&&x&&N(f,x)}catch(y){console.log(y.message)}},[f,x]),i.useEffect(()=>{l&&c&&d&&h&&(j({businessGuid:l,userGuid:c,operatingHours:d,businessProfile:h}),u(!1))},[l,c,d,h]);const{register:e,handleSubmit:r,getValues:n,watch:p,setError:P,formState:{errors:Y,isSubmitting:Z}}=T({defaultValues:{},resolver:E(q)});return o?t.jsx("div",{className:"flex justify-center items-center h-screen",children:t.jsx("div",{className:"text-lg",children:"Loading..."})}):t.jsx($,{children:t.jsx(D,{title:"Settings",businessGuid:l,data:g,businessProfile:h,children:t.jsx(R,{children:g&&t.jsx("div",{className:"mt-6",children:t.jsx(M,{data:g,onChange:w,options:_})})})})})};export{he as default};
