import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as i,c as E}from"./components-BgCvqN9p.js";import{s as P,O as k,l as A,P as N,Q as C,S as L,U as O}from"./lib-B5CJHXEq.js";import{A as B}from"./AccountLayout-CNNzrTDI.js";import{C as U}from"./ContentLayout-D_M4y-dK.js";import{u as D}from"./NotificationContext-DexQTEg0.js";import{u as R}from"./OperationContext-C5fIEC6d.js";import{u as T}from"./AuthContext-CJZGuvtq.js";import"./UserMenu-BGcyOhXR.js";import"./index-Bmix0W_x.js";import"./HomeNav-C4_KFq1z.js";import"./SrchNavbar-DgQ69Q48.js";import"./HamburgerSecondary-BXRtfWu4.js";import"./json-BNGep5mz.js";import"./BusinessMenu-Bt_k1cKU.js";import"./BusinessDrawer-DiqxpHSC.js";const $=({businessGuid:o,userGuid:v,facilityFeatures:n,selectedFacilityFeatures:f})=>{const[h,S]=i.useState(!1);D();const[c,y]=i.useState(null),[u,F]=i.useState(null),[m,g]=i.useState(null),{showOperation:x,showError:p,completeOperation:l,showSuccess:b}=R();i.useEffect(()=>{n&&f&&(y(n),F(f))},[n,f]),i.useEffect(()=>{if(c&&u){const s=c.map(a=>{const t=u.find(r=>r.feature_id===a.feature_id);return{...a,active:!!t,user_description:t?t.user_description:void 0}});g(s)}},[c,u]);const w=s=>{g(a=>a.map(t=>t.feature_id===s?{...t,active:!t.active,user_description:t.user_description?t.user_description:""}:t))},_=(s,a)=>{g(t=>t.map(r=>r.feature_id===s?{...r,user_description:a}:r))},d=async()=>{const t="https://edition.garssete.com"+"/api/listing/selected_facility_features";S(!0),x("processing"),await new Promise(r=>setTimeout(r,1e3));try{const r=m.filter(j=>j.active).map(j=>({feature_id:j.feature_id,user_description:j.user_description}));(await fetch(t,{method:"POST",headers:P,body:JSON.stringify({user_guid:v,business_guid:o,selected:r})})).ok?(b("Success","Features saved."),l()):(p("Error","Save failed."),l())}catch(r){console.log(r.message),p("Error","Save failed.")}finally{S(!1)}};return e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Select Facility Features"}),n.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:m==null?void 0:m.map(s=>e.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded cursor-pointer",children:[e.jsxs("div",{children:[e.jsx("input",{onChange:()=>w(s.feature_id),type:"checkbox",checked:s.active,className:"hidden"}),e.jsx("div",{className:`w-5 h-5 border-2 rounded ${s.active?"bg-blue-700":"bg-white"}`})]}),e.jsxs("div",{className:" w-full",children:[e.jsxs("p",{className:"font-medium flex place-items-center gap-2 text-lg",children:[e.jsx("span",{className:"text-lg",children:s.icon}),e.jsx("span",{children:s.name})]}),e.jsx("p",{className:"text-xs ",children:s.description}),e.jsx("div",{className:" w-full h-[100px] mt-1 rounded overflow-hidden",children:e.jsx("textarea",{onClick:()=>w(s.feature_id),onChange:a=>_(s.feature_id,a.target.value),className:`w-full h-full bg-gray-100
                                            border p-3 text-sm rounded-md`,value:s.user_description})})]})]},s.feature_id))}),e.jsx("button",{onClick:d,className:"mt-5 px-4 py-2 bg-blue-600 text-white rounded",children:"Save Selected Features"})]})]})},ae=()=>{i.useEffect(()=>{k(localStorage)},[]);const[o,v]=i.useState(""),[n,f]=i.useState(""),[h,S]=i.useState(null),[c,y]=i.useState(null),[u,F]=i.useState(null),[m,g]=i.useState(!0),{business_guid:x,user_guid:p}=E(),[l,b]=i.useState(null);return T()?(i.useEffect(()=>{const _=async(d,s)=>{v(d),f(s),await C(),S(N);const a=await L(s,d);y(a);const t=await O(d||"");b(t)};try{x&&p&&_(x,p)}catch(d){A(d)}},[x,p,N]),i.useEffect(()=>{o&&n&&h&&c&&l&&(F({businessGuid:o,userGuid:n,facilityFeatures:h,selectedFacilityFeatures:c,businessProfile:l}),g(!1))},[o,n,h,c,l]),m?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"text-lg",children:"Loading..."})}):e.jsx(B,{children:e.jsx(U,{businessGuid:o,data:u,businessProfile:l,title:"Facility Features",children:u&&e.jsx($,{userGuid:n,businessGuid:o,facilityFeatures:h,selectedFacilityFeatures:c})})})):null};export{ae as default};
